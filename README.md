# OMML IU F23 Project: Loopless stochastic methods

## Team

- Dmitry Beresnev (<d.beresnev@innopolis.university>)
- Vsevolod Klyushev (<v.klyushev@innopolis.university>)

## Introduction

This repository contains project data for Optimization Methods for Machine Learning F23 IU course

## Requirements

Code was tested on Windows 11 and Python 3.11

All the requirement packages are listed in the file `requirements.txt`. In case you use the `pipenv` package, there is also `Pipfile` in the root of the project.

## Before start

Install all the packages from _requirements.txt_ using `pip install -r requirements.txt` or using **pipenv**: `pipenv install` or `pipenv install -d` for dev packages.

Optionally, you can run `bash setup_precommit.sh` to setup pre-commit hook for GitHub for code formatting using [ruff](https://docs.astral.sh/ruff/).

I also highly recommend to read reports in corresponding `reports` folder to fully understand context and purpose of some files and folders.

## Repository structure

```text
├── README.md                 # The top-level README
|
├── data
│   ├── figures               # Figures generated by scripts
│   ├── interim               # Datasets generated by notebooks and scripts
|   |   ├── configs.json      # Configs for evaluation script
|   |   └── mnist_binary.csv  # Reduced MNIST dataset with only two labels
│   └── raw                   # The original, immutable datasets
|       ├── mnist.csv
|       └── mushrooms.txt
|
├── notebooks                     #  Jupyter notebooks
│   ├── data_preprocess.ipynb     # EDA and dataset building
│   ├── experiments.ipynb         # Comparison of different methods on theoretically analyzed function
│   └── nn_experiments.ipynb      # Comparison of different methods on some NN architectures
│
├── references      # Reference papers
│
├── reports                 # Generated analysis as HTML, PDF, LaTeX, etc.
│   ├── papers_overview     # Overview of reference papers
│   └── Presentation.pdf    # FInal presentation
│
├── requirements.txt        # The requirements file for reproducing the analysis environment
│                      generated with `pip freeze › requirements. txt`
|
├── Pipfile                   # File with dependencies for pipenv
├── Pipfile.lock              # File with locked dependencies for pipenv
├── pyproject.toml            # Formatter and linter settings
└── setup_precommit.sh        # Script for creating pre-commit GitHub hook
```

## Basic usage

This section briefly describes how to use scripts from `src/` folder.

For all scripts help messages are available with `-h` flag. For example, `python ./src/evaluate.py -h` explains all the available flags and their purpose.
Generally, for all scripts two modes are available: verbose and non-verbose.
By default verbose mode is active, and to run the script in silent mode you need the `--no-verbose` flag.

Generally, you can run each script with no flags at all. However, I **highly recommend** to always read the help messages before using scripts.

`./src/evaluate.py` script is used for evaluation of different methods.
You can specify model (by name) and dataset (also by name) for evaluation.
Be default, resulting plots is saved to `.data/figures/` in .svg format.

## References

### Papers

- [Don’t Jump Through Hoops and Remove Those Loops: SVRG and Katyusha are Better Without the Outer Loop](https://proceedings.mlr.press/v117/kovalev20a.html)
- [PAGE: A Simple and Optimal Probabilistic Gradient Estimator for Nonconvex Optimization](https://proceedings.mlr.press/v139/li21a.html)

### Books

- [Methods Of Convex Optimization by Yuri Nesterov, 2010](https://mipt.ru/dcam/upload/abb/nesterovfinal-arpgzk47dcy.pdf)

### Datasets

- [MNIST](http://yann.lecun.com/exdb/mnist/)

## Contacts

In case of any questions you can contact me via email <d.beresnev@innopolis.university> or Telegram **@d.flip.floppa**
